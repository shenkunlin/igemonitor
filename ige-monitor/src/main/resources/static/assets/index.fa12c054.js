var C=Object.defineProperty;var d=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var m=(e,t,a)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,s=(e,t)=>{for(var a in t||(t={}))w.call(t,a)&&m(e,a,t[a]);if(d)for(var a of d(t))T.call(t,a)&&m(e,a,t[a]);return e};import{V as n,n as o,A as N}from"./index.a1219e87.js";import{C as x,m as $}from"./index.8e90c859.js";import{g as v,a as S,u as I,S as A,e as k}from"./server-config.de2c5900.js";import{b as l}from"./namespace-config.5600bdfa.js";const O={id:void 0,serverName:"",namespaceId:"",serverType:1};var V=n.extend({props:{id:{type:Number},visible:{type:Boolean}},data(){return{rules:{serverName:[{required:!0,message:"\u8BF7\u8F93\u5165",type:"error"}],serverType:[{required:!0,message:"\u8BF7\u9009\u62E9",type:"error"}],configContent:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E",type:"error"}]},formData:s({},O),namespaceOptions:[],serverTypeOptions:[{label:"FastDFS",value:1},{label:"AliyunOSS",value:2},{label:"MinIO",value:3}]}},computed:{formVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},methods:{opened(){this.queryAllNamespaces(),this.id&&this.init(this.id)},async queryAllNamespaces(){const{data:e}=await l();this.namespaceOptions=e.map(t=>(t.label=t.namespaceName,t.value=t.id,t))},async init(e){const{data:t}=await v(e);this.formData.id=t.id,this.formData.serverName=t.serverName,this.formData.namespaceId=t.namespaceId,this.formData.serverType=t.serverType,this.formData.configContent=t.configContent},async onSubmit({result:e,firstError:t}){t||(this.formData.id?await I({id:this.formData.id,serverName:this.formData.serverName,namespaceId:this.formData.namespaceId,serverType:this.formData.serverType,configContent:this.formData.configContent}):await S({serverName:this.formData.serverName,namespaceId:this.formData.namespaceId,serverType:this.formData.serverType,configContent:this.formData.configContent}),this.$message.success("\u63D0\u4EA4\u6210\u529F"),this.formVisible=!1,this.$emit("refreshDataList"))},onClickCloseBtn(){this.formVisible=!1},closed(){this.$nextTick(()=>{this.$refs.form.reset()})}}}),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("t-dialog",{attrs:{header:(this.id?"\u7F16\u8F91":"\u6DFB\u52A0")+"\u670D\u52A1",visible:e.formVisible,width:600,footer:!1},on:{"update:visible":function(r){e.formVisible=r},opened:e.opened,closed:e.closed}},[a("div",{attrs:{slot:"body"},slot:"body"},[a("t-form",{ref:"form",attrs:{data:e.formData,rules:e.rules,resetType:"initial",labelWidth:100,requiredMark:!1},on:{submit:e.onSubmit}},[a("t-form-item",{attrs:{label:"\u670D\u52A1\u540D\u79F0\uFF1A",name:"serverName"}},[a("t-input",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165"},model:{value:e.formData.serverName,callback:function(r){e.$set(e.formData,"serverName",r)},expression:"formData.serverName"}})],1),a("t-form-item",{attrs:{label:"\u670D\u52A1\u7C7B\u578B\uFF1A",name:"serverType"}},[a("t-select",{style:{width:"480px"},attrs:{clearable:""},model:{value:e.formData.serverType,callback:function(r){e.$set(e.formData,"serverType",r)},expression:"formData.serverType"}},e._l(e.serverTypeOptions,function(r,i){return a("t-option",{key:i,attrs:{value:r.value,label:r.label}},[e._v(" "+e._s(r.label)+" ")])}),1)],1),[a("t-form-item",{attrs:{label:"\u670D\u52A1\u914D\u7F6E\uFF1A",name:"template"}},[a("codemirror",{model:{value:e.formData.configContent,callback:function(r){e.$set(e.formData,"configContent",r)},expression:"formData.configContent"}})],1)],a("t-form-item",{staticStyle:{float:"right"}},[a("t-button",{attrs:{variant:"outline"},on:{click:e.onClickCloseBtn}},[e._v("\u53D6\u6D88")]),a("t-button",{attrs:{theme:"primary",type:"submit"}},[e._v("\u786E\u5B9A")])],1)],2)],1)])},F=[];h._withStripped=!0;const u={};var b=o(V,h,F,!1,E,null,null,null);function E(e){for(let t in u)this[t]=u[t]}b.options.__file="src/pages/server-config/components/add-or-update-dialog.vue";var L=function(){return b.exports}();const q={id:void 0,serverType:1};var R=n.extend({props:{id:{type:Number},visible:{type:Boolean}},data(){return{formData:s({},q),namespaceOptions:[],serverTypeOptions:[{label:"FastDFS",value:1},{label:"AliyunOSS",value:2},{label:"MinIO",value:3}]}},computed:{formVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}},namespaceName(){var e;return(e=this.namespaceOptions.find(t=>t.id===this.formData.namespaceId))==null?void 0:e.namespaceName},serverType(){var e;return(e=this.serverTypeOptions.find(t=>t.value===this.formData.serverType))==null?void 0:e.label}},methods:{async opened(){this.queryAllNamespaces(),this.id&&this.init(this.id)},async queryAllNamespaces(){const{data:e}=await l();this.namespaceOptions=e.map(t=>(t.label=t.namespaceName,t.value=t.id,t)),this.formData.namespaceId=this.namespaceOptions[0].value},async init(e){const{data:t}=await v(e);this.formData.id=t.id,this.formData.serverName=t.serverName,this.formData.namespaceId=t.namespaceId,this.formData.serverType=t.serverType,this.formData.configContent=t.configContent}}}),_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("t-dialog",{attrs:{header:"\u670D\u52A1\u8BE6\u60C5",visible:e.formVisible,width:600,footer:!1},on:{"update:visible":function(r){e.formVisible=r},opened:e.opened}},[a("div",{attrs:{slot:"body"},slot:"body"},[a("t-form",{ref:"form",attrs:{data:e.formData,labelWidth:100}},[a("t-form-item",{attrs:{label:"\u670D\u52A1\u540D\u79F0\uFF1A"}},[e._v(e._s(e.formData.serverName))]),a("t-form-item",{attrs:{label:"\u670D\u52A1\u7C7B\u578B\uFF1A",name:"serverType"}},[e._v(e._s(e.serverType))]),[a("t-form-item",{attrs:{label:"\u670D\u52A1\u914D\u7F6E\uFF1A",name:"template"}},[a("codemirror",{model:{value:e.formData.configContent,callback:function(r){e.$set(e.formData,"configContent",r)},expression:"formData.configContent"}})],1)]],2)],1)])},M=[];_._withStripped=!0;const f={};var y=o(R,_,M,!1,B,null,null,null);function B(e){for(let t in f)this[t]=f[t]}y.options.__file="src/pages/server-config/components/detail-dialog.vue";var K=function(){return y.exports}(),U=n.extend({name:"server-config",components:{AddIcon:N,Card:x,AddOrUpdateDialog:L,DetailDialog:K},mixins:[$],data(){return{mixinViewModuleOptions:{getDataListURL:"/api/serverConfig/search",getDataListIsPage:!0,activatedIsNeed:!1,deleteURL:"/api/serverConfig"},SERVER_TYPE:A,columns:[{title:"\u670D\u52A1ID",align:"left",width:200,colKey:"id",fixed:"left"},{title:"\u670D\u52A1\u540D\u79F0",width:200,ellipsis:!0,colKey:"serverName"},{title:"\u670D\u52A1\u7C7B\u578B",width:200,ellipsis:!0,colKey:"serverType"},{title:"\u662F\u5426\u542F\u7528",width:200,ellipsis:!0,colKey:"enable"},{align:"left",fixed:"right",width:200,colKey:"op",title:"\u64CD\u4F5C"}],formData:{serverName:void 0,namespaceId:void 0},tabList:[]}},async created(){await this.queryAllNamespaces(),await this.query()},methods:{async queryAllNamespaces(){const{data:e}=await l();this.tabList=e.map(t=>(t.label=t.namespaceName,t.value=t.id,t)),this.formData.namespaceId=this.tabList[0].id},async onChange(e){const{id:t,enable:a}=e;await k(t,a),await this.query()}}}),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("card",[a("t-form",{ref:"form",attrs:{data:e.formData,"label-width":80,colon:""},on:{submit:e.query}},[a("t-row",[a("t-col",{attrs:{flex:"none"}},[a("t-form-item",{attrs:{label:"\u670D\u52A1\u540D\u79F0",name:"name"}},[a("t-input",{staticClass:"form-item-content",style:{width:"182px"},attrs:{type:"search",placeholder:"\u8BF7\u8F93\u5165"},model:{value:e.formData.serverName,callback:function(r){e.$set(e.formData,"serverName",r)},expression:"formData.serverName"}})],1)],1),a("t-col",{attrs:{flex:"auto"}},[a("t-button",{style:{marginLeft:"20px"},attrs:{theme:"primary",type:"submit"}},[e._v(" \u641C\u7D22 ")])],1),a("t-col",{attrs:{flex:"none"}},[a("t-button",{attrs:{theme:"primary"},on:{click:function(r){return e.addOrUpdateHandle()}}},[a("add-icon",{attrs:{slot:"icon"},slot:"icon"}),e._v("\u6DFB\u52A0")],1)],1)],1)],1)],1),a("card",{staticClass:"container-base-margin-top table-content"},[a("div",{staticClass:"table-container"},[a("t-table",{attrs:{columns:e.columns,data:e.dataList,rowKey:e.rowKey,verticalAlign:e.verticalAlign,stripe:e.stripe,bordered:e.bordered,hover:e.hover,pagination:e.pagination,loading:e.dataListLoading},on:{"page-change":e.rehandlePageChange},scopedSlots:e._u([{key:"serverType",fn:function(r){var i=r.row;return[i.serverType===e.SERVER_TYPE.FastDFS?a("p",[e._v("FastDFS")]):e._e(),i.serverType===e.SERVER_TYPE.AliyunOSS?a("p",[e._v("AliyunOSS")]):e._e(),i.serverType===e.SERVER_TYPE.MinIO?a("p",[e._v("MinIO")]):e._e()]}},{key:"enable",fn:function(r){var i=r.row;return[a("t-switch",{attrs:{customValue:[1,2]},on:{change:function(c){return e.onChange(i)}},model:{value:i.enable,callback:function(c){e.$set(i,"enable",c)},expression:"row.enable"}})]}},{key:"op",fn:function(r){return[a("a",{staticClass:"t-button-link",on:{click:function(i){return e.handleClickDetail(r.row.id)}}},[e._v("\u8BE6\u60C5")]),a("a",{staticClass:"t-button-link",on:{click:function(i){return e.addOrUpdateHandle(r.row.id)}}},[e._v("\u7F16\u8F91")]),a("a",{staticClass:"t-button-link",on:{click:function(i){return e.handleClickDelete(r.row.id)}}},[e._v("\u5220\u9664")])]}}])})],1)]),a("add-or-update-dialog",{attrs:{id:e.id,visible:e.addOrUpdateVisible},on:{"update:visible":function(r){e.addOrUpdateVisible=r},refreshDataList:e.getDataList}}),a("detail-dialog",{attrs:{id:e.id,visible:e.detailVisible},on:{"update:visible":function(r){e.detailVisible=r}}}),a("t-dialog",{attrs:{theme:"danger",header:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u6570\u636E\u5417\uFF1F",visible:e.confirmVisible},on:{"update:visible":function(r){e.confirmVisible=r},confirm:e.onConfirmDelete}})],1)},P=[];g._withStripped=!0;const p={};var D=o(U,g,P,!1,Y,"d484308a",null,null);function Y(e){for(let t in p)this[t]=p[t]}D.options.__file="src/pages/server-config/index.vue";var J=function(){return D.exports}();export{J as default};
